# SuperInsight 平台 - 登录账号密码

**日期**: 2026-01-28  
**状态**: ✅ 已验证  
**最后更新**: 2026-01-28

---

## 📋 登录账号汇总

### 系统管理员 (Administrator)

| 项目 | 值 |
|------|-----|
| **角色** | 系统管理员 (Superuser) |
| **邮箱** | `admin@superinsight.local` |
| **密码** | `admin123` |
| **用户名** | `admin` |
| **姓名** | `Administrator` |
| **权限** | 所有权限 (完全访问) |
| **状态** | ✅ 活跃 |

---

## 🔐 登录方式

### 1. Web 前端登录

**访问地址**: http://localhost:5173

**登录步骤**:
1. 打开前端应用
2. 进入登录页面
3. 输入邮箱: `admin@superinsight.local`
4. 输入密码: `admin123`
5. 点击登录

**注意**: 登录表单中的"用户名"字段实际上需要输入邮箱地址

### 2. API 登录

**端点**: `POST /api/auth/login`

**请求示例**:
```bash
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@superinsight.local",
    "password": "admin123"
  }'
```

**响应示例**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "user": {
    "id": "9a5d8773-5fcd-4c02-9abd-33fbc5ca138a",
    "email": "admin@superinsight.local",
    "username": "admin",
    "name": "Administrator",
    "is_active": true,
    "is_superuser": true
  }
}
```

### 3. 使用 Token 访问 API

获取 token 后，在请求头中添加:

```bash
curl -X GET http://localhost:8000/api/auth/me \
  -H "Authorization: Bearer <access_token>"
```

---

## 🧪 登录测试结果

### 最新测试 (2026-01-28)

✅ **管理员账号登录测试**: 成功

| 测试项 | 结果 |
|--------|------|
| 后端 API 登录 | ✅ 通过 |
| 邮箱验证 | ✅ 通过 |
| 密码验证 | ✅ 通过 |
| Token 生成 | ✅ 通过 |
| 用户信息获取 | ✅ 通过 |
| 权限验证 | ✅ 通过 |
| 前端 API 集成 | ✅ 通过 |

### 测试详情

```
测试用户: Administrator (Superuser)
邮箱: admin@superinsight.local
密码: admin123

后端登录结果: ✅ SUCCESS
用户 ID: 9a5d8773-5fcd-4c02-9abd-33fbc5ca138a
用户名: admin
姓名: Administrator
超级用户: True
账户状态: 活跃
Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

前端集成: ✅ 已修复
- 修复了 API 端点前缀 (/api)
- 修复了登录请求字段映射 (username → email)
- 前端现在正确发送邮箱地址到后端
```

---

## 📊 用户权限说明

### 管理员 (Administrator)

**权限范围**: 完全访问

**可执行操作**:
- ✅ 用户管理 (创建、编辑、删除用户)
- ✅ 系统配置 (修改系统设置)
- ✅ 数据管理 (查看、编辑、删除所有数据)
- ✅ 项目管理 (创建、编辑、删除项目)
- ✅ 权限管理 (分配和修改用户权限)
- ✅ 审计日志 (查看所有操作日志)
- ✅ 监控和告警 (配置监控规则)
- ✅ 备份和恢复 (执行数据备份和恢复)

---

## 🔑 密钥信息

### JWT 配置

| 项目 | 值 |
|------|-----|
| **算法** | HS256 |
| **过期时间** | 30 分钟 |
| **刷新机制** | 需要重新登录 |

### Token 结构

JWT Token 包含以下信息:
- `sub`: 用户 ID
- `email`: 用户邮箱
- `exp`: 过期时间

---

## ⚠️ 安全建议

### 生产环境

1. **更改默认密码**
   - 首次登录后立即更改管理员密码
   - 使用强密码 (至少 12 个字符，包含大小写字母、数字、特殊符号)

2. **更新 JWT 密钥**
   - 修改 `.env` 文件中的 `JWT_SECRET_KEY`
   - 使用强随机密钥

3. **启用 HTTPS**
   - 在生产环境中使用 HTTPS
   - 配置 SSL/TLS 证书

4. **限制访问**
   - 配置防火墙规则
   - 限制管理员访问 IP

5. **启用多因素认证 (MFA)**
   - 为管理员账户启用 MFA
   - 使用 TOTP 或其他 MFA 方法

6. **定期审计**
   - 定期检查审计日志
   - 监控异常登录活动

### 开发环境

1. **不要在代码中硬编码密码**
   - 使用环境变量
   - 使用 `.env` 文件 (不提交到 Git)

2. **定期更新依赖**
   - 保持 Python 包最新
   - 修复安全漏洞

3. **使用强密码**
   - 即使在开发环境也使用强密码
   - 避免使用 "admin123" 等简单密码

---

## 🔄 密码重置

### 通过 API 重置密码

**端点**: `POST /api/auth/reset-password`

**请求示例**:
```bash
curl -X POST http://localhost:8000/api/auth/reset-password \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@superinsight.local",
    "new_password": "new-secure-password"
  }'
```

### 通过数据库重置密码

如果忘记密码，可以通过数据库直接重置:

```sql
-- 连接到 PostgreSQL
psql -h localhost -U postgres -d superinsight

-- 生成新密码哈希 (使用 bcrypt)
-- 在 Python 中执行:
-- import bcrypt
-- bcrypt.hashpw(b"new-password", bcrypt.gensalt()).decode('utf-8')

-- 更新用户密码
UPDATE users 
SET password_hash = '<new-hash>' 
WHERE email = 'admin@superinsight.local';
```

---

## 📞 常见问题

### Q: 忘记了管理员密码怎么办？

**A**: 
1. 通过数据库重置密码 (见上面的说明)
2. 或者删除用户并重新初始化数据库
3. 在生产环境中，应该有密码恢复流程

### Q: 如何创建新用户？

**A**: 
1. 使用管理员账户登录
2. 进入用户管理页面
3. 点击"创建用户"
4. 填写用户信息
5. 设置初始密码
6. 保存

### Q: 如何修改用户权限？

**A**:
1. 使用管理员账户登录
2. 进入用户管理页面
3. 选择要修改的用户
4. 修改权限设置
5. 保存

### Q: Token 过期了怎么办？

**A**:
- Token 过期后需要重新登录
- 获取新的 Token
- 使用新 Token 继续访问 API

### Q: 如何在 API 中使用 Token？

**A**:
在请求头中添加 `Authorization` 字段:
```
Authorization: Bearer <access_token>
```

### Q: 前端登录表单中的"用户名"字段应该输入什么？

**A**:
输入邮箱地址，例如: `admin@superinsight.local`
前端会自动将其转换为邮箱字段发送到后端

---

## 🔗 相关链接

- [API 文档](http://localhost:8000/docs)
- [前端应用](http://localhost:5173)
- [系统健康检查](http://localhost:8000/health)

---

## 📝 更新日志

### 2026-01-28 (最新)
- ✅ 修复前端 API 端点前缀问题
- ✅ 修复登录请求字段映射 (username → email)
- ✅ 验证后端登录 API 正常工作
- ✅ 验证数据库中存在管理员用户
- ✅ 更新文档说明前端登录流程

### 2026-01-28 (早期)
- ✅ 创建登录账号密码文档
- ✅ 测试管理员账户登录
- ✅ 验证 Token 生成和使用
- ✅ 添加安全建议

---

**文档状态**: ✅ 已验证  
**最后验证时间**: 2026-01-28 17:23:27  
**验证结果**: 所有登录测试通过 ✅
