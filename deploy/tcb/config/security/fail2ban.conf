# SuperInsight TCB Fail2Ban Configuration
# Protects against brute force attacks

[DEFAULT]
# Ban hosts for 1 hour
bantime = 3600
# Find time window of 10 minutes
findtime = 600
# Max retry attempts
maxretry = 5
# Backend for log monitoring
backend = auto

[superinsight-api]
enabled = true
port = 8000
protocol = tcp
filter = superinsight-api
logpath = /app/logs/fastapi.log
maxretry = 10
bantime = 1800

[superinsight-labelstudio]
enabled = true
port = 8080
protocol = tcp
filter = superinsight-labelstudio
logpath = /app/logs/label-studio.log
maxretry = 5
bantime = 3600

[postgresql]
enabled = true
port = 5432
protocol = tcp
filter = postgresql
logpath = /var/log/supervisor/postgres.log
maxretry = 3
bantime = 7200

[redis]
enabled = true
port = 6379
protocol = tcp
filter = redis
logpath = /var/log/supervisor/redis.log
maxretry = 5
bantime = 1800