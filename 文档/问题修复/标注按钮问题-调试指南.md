# æ ‡æ³¨æŒ‰é’®é‡å®šå‘é—®é¢˜ - è°ƒè¯•æŒ‡å—

**æ—¥æœŸ**: 2026-01-28  
**é—®é¢˜**: ç‚¹å‡»"å¼€å§‹æ ‡æ³¨"å’Œ"åœ¨æ–°çª—å£æ‰“å¼€"æŒ‰é’®é‡å®šå‘åˆ°dashboard  
**çŠ¶æ€**: ç­‰å¾…ç”¨æˆ·æä¾›æµè§ˆå™¨è°ƒè¯•ä¿¡æ¯

## åŸºç¡€è®¾æ–½æ£€æŸ¥ç»“æœ âœ…

å·²è¿è¡Œè¿æ¥æµ‹è¯•è„šæœ¬ `scripts/test-label-studio-connection.sh`ï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š

- âœ… Label Studioå®¹å™¨è¿è¡Œæ­£å¸¸ä¸”å¥åº·
- âœ… Label Studioå¯ä»ä¸»æœºè®¿é—® (http://localhost:8080)
- âœ… Label Studio APIå¯ä»åç«¯å®¹å™¨è®¿é—®
- âœ… ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- âœ… åç«¯APIç«¯ç‚¹å­˜åœ¨
- âœ… è¿‘æœŸæ—¥å¿—æ— Label Studioé”™è¯¯

**ç»“è®º**: åŸºç¡€è®¾æ–½æ­£å¸¸ï¼Œé—®é¢˜åœ¨åº”ç”¨å±‚é¢ã€‚

## éœ€è¦ç”¨æˆ·æä¾›çš„è°ƒè¯•ä¿¡æ¯

### æ­¥éª¤1: æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä»»åŠ¡è¯¦æƒ…é¡µé¢
2. æŒ‰ `F12` æˆ–å³é”®ç‚¹å‡» â†’ "æ£€æŸ¥"
3. åˆ‡æ¢åˆ° **Console** æ ‡ç­¾é¡µ

### æ­¥éª¤2: ç‚¹å‡»"å¼€å§‹æ ‡æ³¨"æŒ‰é’®å¹¶è®°å½•æ—¥å¿—

ç‚¹å‡»æŒ‰é’®åï¼ŒæŸ¥æ‰¾ä»¥ä¸‹æ—¥å¿—ï¼š

```
[handleStartAnnotation] Starting... {taskId: "..."}
[handleStartAnnotation] Current project ID: ...
[handleStartAnnotation] Validating project...
[handleStartAnnotation] Validation result: {...}
```

**è¯·æä¾›**:
- æ‰€æœ‰ä»¥ `[handleStartAnnotation]` å¼€å¤´çš„æ—¥å¿—
- ä»»ä½•çº¢è‰²é”™è¯¯æ¶ˆæ¯
- ä»»ä½•è­¦å‘Šæ¶ˆæ¯

### æ­¥éª¤3: æ£€æŸ¥Networkæ ‡ç­¾é¡µ

1. åˆ‡æ¢åˆ° **Network** æ ‡ç­¾é¡µ
2. æ¸…ç©ºç°æœ‰è¯·æ±‚ï¼ˆç‚¹å‡»ğŸš«å›¾æ ‡ï¼‰
3. å†æ¬¡ç‚¹å‡»"å¼€å§‹æ ‡æ³¨"æŒ‰é’®
4. æŸ¥çœ‹å‘å‡ºçš„APIè¯·æ±‚

**è¯·æ£€æŸ¥å¹¶æä¾›ä»¥ä¸‹ä¿¡æ¯**:

#### è¯·æ±‚1: éªŒè¯é¡¹ç›®
- **URL**: `GET /api/label-studio/projects/{project_id}/validate`
- **çŠ¶æ€ç **: ?
- **å“åº”å†…å®¹**: ?

#### è¯·æ±‚2: ç¡®ä¿é¡¹ç›®å­˜åœ¨
- **URL**: `POST /api/label-studio/projects/ensure`
- **çŠ¶æ€ç **: ?
- **è¯·æ±‚ä½“**: ?
- **å“åº”å†…å®¹**: ?

#### è¯·æ±‚3: è·å–è®¤è¯URLï¼ˆå¦‚æœæœ‰ï¼‰
- **URL**: `GET /api/label-studio/projects/{project_id}/auth-url`
- **çŠ¶æ€ç **: ?
- **å“åº”å†…å®¹**: ?

### æ­¥éª¤4: æˆªå›¾

è¯·æä¾›ä»¥ä¸‹æˆªå›¾ï¼š
1. Consoleæ ‡ç­¾é¡µçš„å®Œæ•´è¾“å‡º
2. Networkæ ‡ç­¾é¡µæ˜¾ç¤ºçš„APIè¯·æ±‚åˆ—è¡¨
3. ä»»ä½•å¤±è´¥è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼ˆç‚¹å‡»è¯·æ±‚ â†’ Preview/Responseæ ‡ç­¾ï¼‰

## å¯èƒ½çš„é—®é¢˜åœºæ™¯

### åœºæ™¯A: è®¤è¯å¤±è´¥ (401)

**ç—‡çŠ¶**:
- Networkæ˜¾ç¤º401çŠ¶æ€ç 
- Consoleæ˜¾ç¤º "Authentication failed"

**åŸå› **: ç”¨æˆ·tokenè¿‡æœŸæˆ–æ— æ•ˆ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ¸…é™¤æµè§ˆå™¨localStorage
# åœ¨Consoleä¸­è¿è¡Œ:
localStorage.clear()

# 2. é‡æ–°ç™»å½•
# åˆ·æ–°é¡µé¢ï¼Œé‡æ–°ç™»å½•ç³»ç»Ÿ
```

### åœºæ™¯B: é¡¹ç›®ä¸å­˜åœ¨ (404)

**ç—‡çŠ¶**:
- Networkæ˜¾ç¤º404çŠ¶æ€ç 
- Consoleæ˜¾ç¤º "Project not found"

**åŸå› **: Label Studioé¡¹ç›®IDä¸å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ä»»åŠ¡çš„label_studio_project_idå­—æ®µ
# å¦‚æœä¸ºç©ºæˆ–æ— æ•ˆï¼Œç³»ç»Ÿåº”è¯¥è‡ªåŠ¨åˆ›å»ºé¡¹ç›®
# å¦‚æœè‡ªåŠ¨åˆ›å»ºå¤±è´¥ï¼ŒæŸ¥çœ‹åç«¯æ—¥å¿—:
docker logs superinsight-app --tail 100 | grep -i "ensure.*project"
```

### åœºæ™¯C: Label StudioæœåŠ¡ä¸å¯ç”¨ (503)

**ç—‡çŠ¶**:
- Networkæ˜¾ç¤º503çŠ¶æ€ç 
- Consoleæ˜¾ç¤º "Service unavailable"

**åŸå› **: Label StudioæœåŠ¡æš‚æ—¶ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡å¯Label Studio
docker restart superinsight-label-studio

# ç­‰å¾…30ç§’
sleep 30

# æ£€æŸ¥çŠ¶æ€
docker ps | grep label-studio
```

### åœºæ™¯D: CORSé”™è¯¯

**ç—‡çŠ¶**:
- Consoleæ˜¾ç¤º "CORS policy" é”™è¯¯
- Networkè¯·æ±‚æ˜¾ç¤ºä¸º "CORS error"

**åŸå› **: è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥åç«¯CORSé…ç½®
docker exec superinsight-app grep -r "CORS" /app/src/
```

### åœºæ™¯E: å‰ç«¯ä»£ç æœªæ›´æ–°

**ç—‡çŠ¶**:
- Consoleæ—¥å¿—æ ¼å¼ä¸ä»£ç ä¸åŒ¹é…
- æŒ‰é’®è¡Œä¸ºä¸é¢„æœŸä¸ç¬¦

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…é™¤å‰ç«¯ç¼“å­˜å¹¶é‡æ–°æ„å»º
cd frontend
rm -rf node_modules/.vite
rm -rf dist
npm run build

# æˆ–é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev

# ç„¶ååœ¨æµè§ˆå™¨ä¸­ç¡¬åˆ·æ–° (Ctrl+Shift+R æˆ– Cmd+Shift+R)
```

## ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

å¦‚æœé—®é¢˜æ— æ³•ç«‹å³è§£å†³ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸´æ—¶æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆ1: ç›´æ¥ä½¿ç”¨Label Studio

1. è®¿é—® http://localhost:8080
2. ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•:
   - Email: admin@example.com
   - Password: admin
3. æ‰‹åŠ¨åˆ›å»ºé¡¹ç›®å¹¶å¯¼å…¥æ•°æ®

### æ–¹æ¡ˆ2: ä½¿ç”¨APIç›´æ¥æµ‹è¯•

```bash
# è·å–è®¤è¯token
TOKEN="your_token_here"

# æµ‹è¯•éªŒè¯é¡¹ç›®API
curl -X GET "http://localhost:8000/api/label-studio/projects/123/validate" \
  -H "Authorization: Bearer $TOKEN"

# æµ‹è¯•ç¡®ä¿é¡¹ç›®API
curl -X POST "http://localhost:8000/api/label-studio/projects/ensure" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "task_id": "your_task_id",
    "task_name": "Test Project",
    "annotation_type": "text_classification"
  }'
```

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**è¯·æŒ‰ç…§"éœ€è¦ç”¨æˆ·æä¾›çš„è°ƒè¯•ä¿¡æ¯"éƒ¨åˆ†çš„æ­¥éª¤æ“ä½œï¼Œå¹¶æä¾›ï¼š**

1. âœ… Consoleæ ‡ç­¾é¡µçš„æ—¥å¿—è¾“å‡º
2. âœ… Networkæ ‡ç­¾é¡µçš„APIè¯·æ±‚è¯¦æƒ…
3. âœ… ä»»ä½•é”™è¯¯æ¶ˆæ¯çš„æˆªå›¾

**æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œæˆ‘å¯ä»¥ï¼š**
- ç²¾ç¡®å®šä½é—®é¢˜æ ¹æº
- æä¾›å…·ä½“çš„ä¿®å¤æ–¹æ¡ˆ
- å¿…è¦æ—¶ä¿®æ”¹ä»£ç 

## ç›¸å…³æ–‡æ¡£

- `æ–‡æ¡£/é—®é¢˜ä¿®å¤/æ ‡æ³¨æŒ‰é’®é‡å®šå‘é—®é¢˜è¯Šæ–­.md` - è¯¦ç»†è¯Šæ–­æ–‡æ¡£
- `scripts/test-label-studio-connection.sh` - è¿æ¥æµ‹è¯•è„šæœ¬
- `.kiro/specs/label-studio-annotation-navigation-fix/` - åŠŸèƒ½è§„èŒƒ

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. æµè§ˆå™¨Consoleæˆªå›¾
2. Networkæ ‡ç­¾é¡µæˆªå›¾
3. å…·ä½“çš„é”™è¯¯æ¶ˆæ¯
